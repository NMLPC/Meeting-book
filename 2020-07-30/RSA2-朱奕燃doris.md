### RSA2
```python
e = 65537
n = 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113
dp = 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657
c = 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751
```
首先我们有基本公式:
$$
\begin{align}
c &= m^{e} \pmod n \tag{1}\\
m &=c^{d} \pmod n \tag{2}\\
ed &= 1 \pmod {\phi(n)} \tag{3}
\end{align}
$$

然后对应题目里的 `dp`，我们可以也转化成同余式：<u>（很常见）</u>
$$
dp ≡ d \pmod{(p-1)} \tag{4}
$$

 接着，对上面的几条公式进行分析，<u>希望能够获得有关 `p` 和 `q` 分解的信息</u>。

关键在于 `(4)`，和 `(3)` 关联 —— 同乘以 `e`：
$$
edp ≡ ed \pmod{(p-1)}
$$

接下来尝试将同余式转化成等式进行分析。
$$
ed = k_1 \times (p-1) + edp
$$

$$
k_2 \times (p-1)\times (q-1)+1 = k_1 \times (p-1) + edp
$$

$$
(p-1) \times [k_2\times(q-1)-k_1] = e \times dp-1 \,\,\; \tag{*}
$$

把 $[k_2\times(q-1)-k_1]$ 看成一个整体。

由于 $dp < p-1$，我们可以得到
$$
(p-1) \times [k_2\times(q-1)-k_1]<e\times(p-1)
$$
我们因此可以得到
$$
0<k_2\times(q-1)-k_1<e
$$
 由于题目中的公钥 e 比较小，因此我们可以通过枚举法得出 q。（利用 `(*)` ）

代码:

```python
import libnum
e = 65537
n = 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113
dp = 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657
c = 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751
edp=e*dp
def ext_euclid(a, b):     #扩展欧几里得辗转相除
    old_s,s=1,0
    old_t,t=0,1
    old_r,r=a,b
    if b == 0:
        return 1, 0, a
    else:
        while(r!=0):
            q=old_r//r
            old_r,r=r,old_r-q*r
            old_s,s=s,old_s-q*s
            old_t,t=t,old_t-q*t
    return old_s
for i in range(1,e):
    if (edp-1)%i==0:
        p=(edp-1)//i+1
        if n%p==0:
            q=n//p
fn=(p-1)*(q-1)
d=ext_euclid(e,fn)
m=pow(c,d,n)
print(libnum.n2s(m))
```



